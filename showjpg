#!/bin/sh

export LANG=c

image=$1
LOGS_DIR=$2

if [ "$LOGS_DIR" != "" ] && [ -d $LOGS_DIR ]]; then
	log=$LOGS_DIR/fbv.log
else
	log=/dev/null
fi

if [ -e "x$some_variable" ]; then
	cat /dev/zero > /dev/fb0 2>/dev/null;
	/usr/local/bin/fbv -quickfe $image 2>&1 >> $log
else
	# perhaps we want to cycle through different backgrounds?
	background=background.jpg
	if [ -e $background ]; then
		# we should already be showing final.png with gthumb
		FZ=45
		COL=\#00ff00
		convert ${image} -write mpr:AB +delete -respect-parentheses \( mpr:AB -fuzz ${FZ}% -transparent ${COL} +write mpr:CD \) \( background.jpg mpr:CD -gravity center -composite +write ${image}.out.png \) \)

		# gThumg needs to be configured to enable Preferences->"Reuse the active window to open files"
		gthumb -f ${image}.out.png &
	else
		gthumb -f ${image} &
	fi
fi
